<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sudan Play - متجر التطبيقات السوداني</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* الأنماط السابقة تبقى كما هي */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: rgb(74, 107, 255);
            --secondary: rgb(255, 94, 125);
            --accent: rgb(46, 196, 182);
            --dark: rgb(30, 30, 45);
            --light: rgb(248, 249, 254);
            --gradient: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            --gradient-light: linear-gradient(135deg, rgba(74, 107, 255, 0.1) 0%, rgba(255, 94, 125, 0.1) 100%);
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        body {
            background-color: var(--light);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* --- Header / Navigation --- */
        header {
            background-color: var(--dark);
            color: var(--light);
            padding: 15px 20px;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }

        .logo {
            display: flex;
            align-items: center;
            font-size: 1.8em;
            font-weight: bold;
        }
        
        .logo h1 {
            color: var(--light);
            font-size: 1.5em;
        }

        .nav-links {
            display: flex;
            align-items: center;
        }

        .nav-links a {
            color: var(--light);
            text-decoration: none;
            margin-right: 20px;
            font-size: 1em;
            transition: color 0.3s;
            white-space: nowrap;
        }

        .nav-links a:hover {
            color: var(--secondary);
        }

        /* زر نشر تطبيق جديد */
        .submit-app-btn {
            background: var(--secondary);
            color: var(--light);
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            transition: background 0.3s;
            margin-right: 10px;
        }

        .submit-app-btn:hover {
            background: rgb(200, 70, 95);
        }

        /* --- Hero Section --- */
        .hero {
            background: var(--gradient);
            color: var(--light);
            padding: 60px 20px;
            text-align: center;
        }

        .hero h2 {
            font-size: 2.2em;
            margin-bottom: 10px;
            line-height: 1.3;
        }

        .hero p {
            font-size: 1.1em;
            opacity: 0.9;
            margin-bottom: 30px;
            line-height: 1.5;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero button {
            background-color: var(--dark);
            color: var(--light);
            border: none;
            padding: 14px 30px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.3s, transform 0.3s;
        }

        .hero button:hover {
            background-color: #000;
            transform: translateY(-3px);
        }

        /* --- نافذة نشر التطبيق --- */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: var(--light);
            margin: 5% auto;
            padding: 25px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-btn {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            position: absolute;
            top: 15px;
            left: 20px;
            cursor: pointer;
            z-index: 1;
        }

        .close-btn:hover,
        .close-btn:focus {
            color: var(--secondary);
            text-decoration: none;
        }

        .submit-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--dark);
        }

        .form-control {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 2px rgba(74, 107, 255, 0.2);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .bank-info {
            background-color: var(--gradient-light);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-right: 4px solid var(--primary);
        }

        .bank-info h4 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        .bank-info p {
            margin: 5px 0;
            color: var(--dark);
        }

        .submit-btn {
            background: var(--gradient);
            color: var(--light);
            border: none;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: opacity 0.3s;
            margin-top: 10px;
        }

        .submit-btn:hover {
            opacity: 0.9;
        }

        .submit-btn.loading {
            pointer-events: none;
            position: relative;
            color: transparent !important;
        }

        .submit-btn.loading::after {
            content: "";
            position: absolute;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* --- إضافة تصميم شريط الرسائل التفاعلية (Toast/Snackbar) --- */
        #toast-message {
            visibility: hidden;
            min-width: 250px;
            background-color: var(--dark);
            color: var(--light);
            text-align: center;
            border-radius: 8px;
            padding: 16px;
            position: fixed;
            z-index: 3000;
            left: 50%;
            transform: translateX(-50%);
            bottom: 30px;
            font-size: 1.1em;
            box-shadow: var(--shadow);
            transition: visibility 0s, opacity 0.5s linear;
            opacity: 0;
            max-width: 90%;
        }

        #toast-message.show {
            visibility: visible;
            opacity: 1;
        }

        /* تصميم الاستجابة للهواتف والأجهزة اللوحية */
        @media (max-width: 768px) {
            header {
                padding: 12px 15px;
            }
            
            nav {
                flex-direction: column;
                align-items: flex-start;
            }

            .logo {
                margin-bottom: 10px;
            }
            
            .logo h1 {
                font-size: 1.3em;
            }

            .nav-links {
                margin-top: 10px;
                width: 100%;
                justify-content: space-between;
            }

            .nav-links a {
                margin-right: 0;
                font-size: 0.9em;
                padding: 5px 0;
            }

            .submit-app-btn {
                margin-top: 10px;
                width: 100%;
                text-align: center;
            }

            .hero {
                padding: 50px 15px;
            }

            .hero h2 {
                font-size: 1.8em;
            }

            .hero button {
                padding: 12px 25px;
                font-size: 1em;
            }

            .modal-content {
                margin: 10% auto;
                padding: 20px;
                width: 95%;
            }
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="logo">
                <h1>Sudan Play</h1>
            </div>
            <div class="nav-links">
                <a href="#apps"><i class="fas fa-th"></i> التطبيقات</a>
                <a href="#about"><i class="fas fa-info-circle"></i> عن المتجر</a>
                <a href="#contact"><i class="fas fa-envelope"></i> تواصل معنا</a>
                <button class="submit-app-btn" onclick="openSubmitAppModal()">
                    <i class="fas fa-plus"></i> نشر تطبيق
                </button>
            </div>
        </nav>
    </header>

    <section class="hero">
        <h2>متجر التطبيقات السوداني</h2>
        <p>اكتشف وحمل أفضل التطبيقات والألعاب المحلية والعالمية المصممة خصيصًا لك.</p>
        <a href="#apps"><button>ابدأ التصفح <i class="fas fa-arrow-down"></i></button></a>
    </section>

    <!-- نافذة نشر التطبيق -->
    <div id="submitAppModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeSubmitAppModal()">&times;</span>
            <h2 style="color: var(--primary); margin-bottom: 20px;">نشر تطبيق جديد</h2>
            
            <div class="bank-info">
                <h4><i class="fas fa-university"></i> معلومات الحساب البنكي</h4>
                <p><strong>اسم البنك:</strong> بنك السودان المركزي</p>
                <p><strong>رقم الحساب:</strong> 1234567890</p>
                <p><strong>اسم المستفيد:</strong> Monty GO SDN-Co.LTD</p>
                <p><strong>مبلغ التحويل:</strong> 50 جنيه سوداني</p>
            </div>
            
            <form class="submit-form" id="submitAppForm">
                <div class="form-group">
                    <label for="appType">نوع التطبيق</label>
                    <select id="appType" class="form-control" required>
                        <option value="">اختر نوع التطبيق</option>
                        <option value="ألعاب">ألعاب</option>
                        <option value="أدوات">أدوات</option>
                        <option value="تواصل">تواصل</option>
                        <option value="تعليم">تعليم</option>
                        <option value="ترفيه">ترفيه</option>
                        <option value="مال وأعمال">مال وأعمال</option>
                        <option value="أخرى">أخرى</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="appName">اسم التطبيق</label>
                    <input type="text" id="appName" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="appImages">روابط صور التطبيق (افصل بينها بفاصلة)</label>
                    <textarea id="appImages" class="form-control form-textarea" placeholder="https://example.com/image1.jpg, https://example.com/image2.jpg"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="appLink">رابط التطبيق (APK أو رابط المتجر)</label>
                    <input type="url" id="appLink" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="transactionId">رقم عملية التحويل البنكي</label>
                    <input type="text" id="transactionId" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="devName">اسم المطور/المستخدم</label>
                    <input type="text" id="devName" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="companyName">اسم الشركة (اختياري)</label>
                    <input type="text" id="companyName" class="form-control">
                </div>
                
                <div class="form-group">
                    <label for="devEmail">البريد الإلكتروني</label>
                    <input type="email" id="devEmail" class="form-control" required>
                </div>
                
                <button type="submit" class="submit-btn" id="submitAppBtn">إرسال الطلب للمراجعة <i class="fas fa-paper-plane"></i></button>
            </form>
        </div>
    </div>

    <div id="toast-message"></div>

    <footer>
        &copy; 2025 Sudan Play. جميع الحقوق محفوظة. - واتساب: 249127432167 - Monty Go SDN-Co.LTD
    </footer>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script> 
    <script>
        // تهيئة Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyBJE_Ee-Dyh83iny45eH8lVtTSrIVqTzOI",
            authDomain: "sudan-play.firebaseapp.com",
            projectId: "sudan-play",
            storageBucket: "sudan-play.firebasestorage.app",
            messagingSenderId: "981764948623",
            appId: "1:981764948623:web:00e5c9268198f70e39a6fa",
            measurementId: "G-Y6NP2MNQR9"
        };

        // تهيئة Firebase
        let db;
        try {
            if (!firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
            }
            db = firebase.firestore();
            console.log("✅ Firebase initialized successfully");
        } catch (error) {
            console.error("❌ Firebase initialization error:", error);
        }

        // دالة عرض الرسائل
        function showToast(message, duration = 3000) {
            const toast = document.getElementById('toast-message');
            toast.textContent = message;
            toast.className = "show";
            
            setTimeout(function() {
                toast.className = toast.className.replace("show", "");
            }, duration);
        }

        // دالة فتح نافذة نشر التطبيق
        function openSubmitAppModal() {
            document.getElementById('submitAppModal').style.display = 'block';
        }

        // دالة إغلاق نافذة نشر التطبيق
        function closeSubmitAppModal() {
            document.getElementById('submitAppModal').style.display = 'none';
        }

        // إرسال نموذج نشر التطبيق
        document.getElementById('submitAppForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitAppBtn');
            const originalText = submitBtn.innerHTML;
            submitBtn.classList.add('loading');
            
            try {
                // جمع بيانات النموذج
                const formData = {
                    appType: document.getElementById('appType').value,
                    appName: document.getElementById('appName').value,
                    appImages: document.getElementById('appImages').value.split(',').map(img => img.trim()).filter(img => img.length > 0),
                    appLink: document.getElementById('appLink').value,
                    transactionId: document.getElementById('transactionId').value,
                    devName: document.getElementById('devName').value,
                    companyName: document.getElementById('companyName').value || '',
                    devEmail: document.getElementById('devEmail').value,
                    reviewStatus: 'Pending', // استخدام reviewStatus بدلاً من status
                    submissionDate: firebase.firestore.FieldValue.serverTimestamp()
                };

                console.log("📤 Sending data to Firebase:", formData);

                // التحقق من اتصال Firebase
                if (!db) {
                    throw new Error("Firebase not initialized");
                }

                // إرسال البيانات إلى مجموعة 'submissions'
                const docRef = await db.collection('submissions').add(formData);
                console.log("✅ Submission successful with ID:", docRef.id);
                
                // إعادة تعيين النموذج وإظهار رسالة النجاح
                submitBtn.classList.remove('loading');
                submitBtn.innerHTML = originalText;
                
                showToast('✅ تم إرسال طلب نشر التطبيق بنجاح وسيتم مراجعته خلال 30 ساعة');
                closeSubmitAppModal();
                document.getElementById('submitAppForm').reset();
                
            } catch (error) {
                console.error("❌ Error submitting app:", error);
                submitBtn.classList.remove('loading');
                submitBtn.innerHTML = originalText;
                
                let errorMessage = 'حدث خطأ أثناء إرسال الطلب، يرجى المحاولة مرة أخرى';
                
                if (error.code) {
                    switch (error.code) {
                        case 'permission-denied':
                            errorMessage = 'خطأ في الأذونات: يرجى التحقق من إعدادات قاعدة البيانات';
                            break;
                        case 'unavailable':
                            errorMessage = 'تعذر الاتصال بالخادم، يرجى التحقق من اتصال الإنترنت';
                            break;
                        case 'invalid-argument':
                            errorMessage = 'بيانات غير صالحة، يرجى التحقق من المدخلات';
                            break;
                        default:
                            errorMessage = `خطأ: ${error.message}`;
                    }
                }
                
                showToast('❌ ' + errorMessage);
            }
        });

        // إغلاق النوافذ المنبثقة عند النقر خارجها
        window.onclick = function(event) {
            const modal = document.getElementById('submitAppModal');
            if (event.target === modal) {
                modal.style.display = "none";
            }
        }

        // اختبار اتصال Firebase عند التحميل
        document.addEventListener('DOMContentLoaded', function() {
            console.log("🚀 Page loaded");
            
            if (db) {
                console.log("✅ Firebase is connected and ready");
                showToast("✅ النظام جاهز", 2000);
            } else {
                console.error("❌ Firebase is not connected");
                showToast("⚠️ تحذير: هناك مشكلة في الاتصال بالخادم", 5000);
            }
        });
    </script>
</body>
</html>
